# 安全合规说明

## 概述

探索伙伴项目面向儿童用户，对内容安全有严格要求。本文档定义了安全合规标准和实施措施。

## 合规要求

### 1. 内容安全过滤
- **强制要求**: 所有AI生成内容必须通过集团安全中心过滤
- **过滤时机**: 输入检查 + 输出过滤
- **过滤类型**: 涉政、涉暴、未成年人保护、敏感信息、色情内容

### 2. 风险等级定义
- **LOW**: 轻微风险，可通过过滤处理
- **MEDIUM**: 中等风险，需要人工审核
- **HIGH**: 高风险，必须拦截并上报
- **REJECT**: 严重违规，立即停止服务

### 3. 监控指标
- 内容过滤成功率 > 99.9%
- 违规内容拦截率 > 99.5%
- 响应时间 < 500ms
- 误报率 < 0.1%

## 安全架构

### 1. 安全过滤流程
```
用户输入 → 输入检查 → AI处理 → 输出过滤 → 返回结果
     ↓         ↓         ↓         ↓         ↓
   拦截     记录     生成     过滤     安全内容
```

### 2. 安全中心集成
```yaml
SecurityConfig:
  BaseURL: "https://security.company.com/api/v1"
  APIKey: "your-security-api-key"
  Timeout: 10
```

### 3. 应急响应机制
1. **实时监控**: 7×24小时监控违规内容
2. **自动拦截**: 检测到违规立即停止输出
3. **日志记录**: 完整记录所有安全事件
4. **告警通知**: 触发阈值时自动告警
5. **人工审核**: 高风险内容进入人工审核流程

## 合规检查类型

### 1. 涉政内容 (politics)
- 检查范围: 政治人物、政治事件、政治观点
- 风险等级: HIGH
- 处理方式: 直接拦截

### 2. 涉暴内容 (violence)
- 检查范围: 暴力描写、恐怖内容、极端行为
- 风险等级: HIGH
- 处理方式: 直接拦截

### 3. 未成年人保护 (minors)
- 检查范围: 儿童隐私、儿童安全、诱导行为
- 风险等级: REJECT
- 处理方式: 立即停止服务并上报

### 4. 敏感信息 (sensitive)
- 检查范围: 个人隐私、商业机密、国家安全
- 风险等级: MEDIUM
- 处理方式: 内容过滤或模糊化

### 5. 色情内容 (pornography)
- 检查范围: 色情描写、性暗示、不良内容
- 风险等级: HIGH
- 处理方式: 直接拦截

## 实施措施

### 1. 代码层安全
```go
// 输入检查
if err := client.checkContentSafe(ctx, input, "text", userID); err != nil {
    return nil, fmt.Errorf("输入内容不合规: %w", err)
}

// 输出过滤
filtered, err := client.filterContent(ctx, rawOutput, "text", userID, sessionID)
if err != nil {
    return nil, fmt.Errorf("输出内容过滤失败: %w", err)
}
```

### 2. 配置要求
- 安全过滤必须默认开启
- 安全中心地址和密钥必须配置
- 超时时间不得超过10秒
- 失败时必须记录详细日志

### 3. 监控告警
- 过滤失败率 > 1% 触发告警
- 违规内容出现立即告警
- 安全中心服务异常立即告警
- 每周生成安全报告

## 责任与联系方式

### 安全负责人
- **姓名**: 邹鹏
- **工号**: 355361
- **职责**: 安全策略制定、应急响应协调

### 技术负责人
- 负责安全功能的技术实现
- 定期进行安全评估
- 处理安全相关技术问题

### 业务负责人
- 负责业务层面的合规要求
- 参与安全策略制定
- 处理业务安全事件

## 附录

### 1. 安全检查API接口
```http
POST /api/v1/content/check
Authorization: Bearer {api_key}
Content-Type: application/json

{
  "content": "待检查内容",
  "content_type": "text|image|audio",
  "scene": "children_education",
  "user_id": "用户ID",
  "session_id": "会话ID",
  "check_types": ["politics", "violence", "minors"]
}
```

### 2. 响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "passed": true,
    "risk_level": "low",
    "suggestion": "内容安全",
    "filtered_content": "过滤后的内容",
    "details": [...]
  }
}
```

### 3. 常见问题
1. **Q**: 如何处理过滤服务异常？
   **A**: 降级到本地规则检查，记录异常并告警

2. **Q**: 误报率过高怎么办？
   **A**: 调整安全规则阈值，优化过滤算法

3. **Q**: 如何证明合规性？
   **A**: 提供完整的安全日志和监控报告

---

**重要提醒**: 安全合规是项目生命周期的核心要求，任何安全风险都可能导致严重后果。请严格按照本规范执行。
